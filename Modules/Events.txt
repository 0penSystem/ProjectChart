VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "Events"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Compare Database

Public WithEvents APP As PowerPoint.Application
Attribute APP.VB_VarHelpID = -1
Private FilePath As String
Public Rec As Recordset

Private Sub App_PresentationCloseFinal(ByVal Pres As PowerPoint.Presentation)

    
    Rec.MoveFirst
      Rec.Edit
   
   Attach = Rec.Fields("PowerPointFile")
   
   With Attach
   .MoveFirst
   .Edit
   .Fields("FileData").LoadFromFile FilePath
   .Update
   End With
   
   Rec.Update
   
   Set PPT = Nothing
   Set AppPPT = Nothing
   Set APP = Nothing
   
   Rec.MoveNext
   
   'Call killFile(filepath)
   
End Sub


Private Sub Class_Initialize()
    Set APP = New PowerPoint.Application
End Sub

Private Sub Class_Terminate()
    'actually gets called when the window closes.
    
End Sub

Public Property Get fp() As String
    fp = FilePath
End Property
Public Property Let fp(Value As String)
    FilePath = Value
End Property

